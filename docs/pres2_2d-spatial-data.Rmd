---
title: Working with 2D and Spatial Data
output: 
  slidy_presentation:
    css: css/slidy_styles.css
    df_print: default
    duration: 0
    font_adjustment: 2
    footer: "Data Analysis and Visualization with R | <a href='https://ajlyons.github.io/sfdata/'>https://ajlyons.github.io/sfdata/</a>"
    self_contained: no
    lib_dir: lib
    smart: no
    includes:
      in_header: header.html
    increment: no
---

# Two-dimensional data

<script language="javascript" type="text/javascript">w3c_slidy.mouse_click_enabled = false;</script>

R has two object types for handling tabular data: **matrices** and **data frames**.

```{r}
head(airquality)
```

There are number of sample datasets that come with R, many of which are data frames. Functions to explore data frames include <tt>names()</tt>, <tt>head()</tt>, <tt>nrow()</tt>, <tt>ncol()</tt>, <tt>dim()</tt>.

```{r}
#View(mtcars)
names(mtcars)
head(mtcars)
nrow(mtcars)
ncol(mtcars)
```

You can grab an individual column by name with the <tt>$</tt> selector. 

```{r plot_wt_mpg, fig.align='center', cache=TRUE}
summary(mtcars$wt)
plot(x=mtcars$wt, y=mtcars$mpg, pch=16, main="Gas Mileage vs Weight")
```

# Filtering Rows and Columns

You can reference specific rows specific rows and columns with square bracket notation. Only this time we need two expressions separated by a comma.

<tt>mydataframe[</tt> *rows* , *cols* <tt>]</tt>

The expression for *rows* & *cols* can be integers (row and column indices), or Booleans. In addition, with data frames you can use a vector of column names to specific the columns. To return all the rows or all the columns, omit the expression. 

```{r}
library(maps)
data(canada.cities)
head(canada.cities)
```

Columns can be specified either by name or index number. The following two expressions are equivalent (note how the expression for *rows* has been omitted, so all rows are returned). 

```{r}
head(canada.cities[,1])
head(canada.cities[,"name"])
```

The *rows* expression can also be an expression that returns logicals.

```{r plot_big_cities, small.mar=TRUE, fig.align='center', cache=TRUE}
idx <- (canada.cities$pop > 100000)
table(idx)
big_cities <- canada.cities[idx,   ]
plot(big_cities[ , c("long","lat")], asp=1, pch=16  )
```

# Working with Files and Folders

Before importing or exporting data, you should set the working directory.

```{r eval=FALSE}
setwd("C:/.../.../data)
```

Tip: You can also use the Session menu 

# Importing a csv

RStudio has a 'import dataset' tool in the upper right pane. 

```{r import_evictions}
evict_df = read.csv("Eviction_Notices.csv")
```

# Spatial Data

<script language="javascript" type="text/javascript">w3c_slidy.mouse_click_enabled = false;</script>

```{r setup, child = 'slides_setup.Rmd', include=FALSE}
```

## Physical World &rarr; GIS World

<div class="incremental centerblock" style="margin-bottom:2em;"><img src="images/layers.jpg"></img></div>

<div class="incremental centerblock" style="margin-bottom:2em;"><img src="images/vectors-features-abstract.png"></img></div>

<div class="incremental centerblock" style="margin-bottom:2em;"><img src="images/raster-features-abstract.png"></img></div>

# Representing Geographic Data 

How would you represent each of the following?

<div class="indented2">
>- city, county, state boundaries
>- air or ocean temperature
>- crime locations
>- buildings
>- roads
>- water fountains
>- elevation
>- soil type
>- land use
</div>

# Projections

<div class="centerblock"><img src="images/projections_550x682.png"></img></div>

<div class="centerblock" style="margin-top:2em;">
<iframe src="http://www.jasondavies.com/maps/transition/" style="width:1234px;height:732px;">
  <p>Your browser does not support iframes.</p>
</iframe>
</div>

# Importing Vector Data: rgdal

<div class="indented1">
- <tt>rgdal</tt> is a wrapper for the Geospatial Data Abstraction Library (GDAL) library.  
- It provides drivers for a wide range of vector and raster data formats. [<a id="qtn_vqmbij" href="#" class="showhideplain" onclick="showHide('vqmbij');return false;">See all</a>]  

<div id="vqmbij" class="answer-code">
```{r}
library(rgdal)
rgdal::ogrDrivers()[,c(2,3,4)]
```
</div>

- Data come in as Spatial* objects (<tt>sp</tt> package).  
- Knows how to read project info  
</div>

```{r echo=TRUE, results='hide', message=FALSE}
library(sp)
library(rgdal)
```


